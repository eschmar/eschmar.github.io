/*
 *  game-of-life.js - v0.1.5
 *  HTML5 canvas game of life.
 *  https://github.com/eschmar/game-of-life
 *
 *  @author:   Marcel Eschmann, @eschmar
 *  @license:  MIT License
 */
;!function(t,i,e,s){"use strict";function n(i,e){this.element=i,this.settings=t.extend({},h,e),this.init()}var h={cellSize:8,colors:["#490D7F","#B666FF","#921AFF","#5B337F","#7515CC"],colorEmpty:"#fafafa",transparent:!0,speed:100,onClick:!1},o,l,a,r,f,c,g;t.extend(n.prototype,{init:function(){this.ctx=this.element.getContext("2d"),this.xLength=Math.floor(this.element.width/this.settings.cellSize),this.yLength=Math.floor(this.element.height/this.settings.cellSize),this.population=[];for(var t=0;t<this.xLength;t++)this.population[t]=[];this.settings.onClick&&this.initOnClick()},initOnClick:function(){var i=this;t(i.element).on("click touchstart",function(e){var s,n,h;s=t(i.element).offset(),n=e.pageX-s.left,h=e.pageY-s.top,i.settings.onClick(i,Math.floor(n/i.settings.cellSize),Math.floor(h/i.settings.cellSize)),e.stopPropagation()})},populate:function(t,i){var e=Math.floor(10*Math.random()%this.settings.colors.length);this.ctx.fillStyle=this.settings.colors[e],this.ctx.fillRect(t*this.settings.cellSize+1,i*this.settings.cellSize+1,this.settings.cellSize-1,this.settings.cellSize-1)},kill:function(t,i){return this.settings.transparent?void this.ctx.clearRect(t*this.settings.cellSize+1,i*this.settings.cellSize+1,this.settings.cellSize-1,this.settings.cellSize-1):(this.ctx.fillStyle=this.settings.colorEmpty,void this.ctx.fillRect(t*this.settings.cellSize+1,i*this.settings.cellSize+1,this.settings.cellSize-1,this.settings.cellSize-1))},live:function(t,i){var e=this.neighbours(t,i);this.population[t][i]&&(2>e||e>3)?this.future[t][i]=!1:3===e&&(this.future[t][i]=!0)},neighbours:function(t,i){for(var e=0,s,n,h=-1;2>h;h++)for(var o=-1;2>o;o++)s=(t+h+this.xLength)%this.xLength,n=(i+o+this.yLength)%this.yLength,this.population[s][n]&&e++;return this.population[t][i]&&e--,e},randomize:function(){for(var t=0;t<this.xLength;t++)for(var i=0;i<this.yLength;i++)Math.floor(10*Math.random()%2)&&(this.populate(t,i,0),this.population[t][i]=!0)},killAll:function(){var i=this.alive;this.alive&&this.toggle();for(var e=0;e<this.xLength;e++)for(var s=0;s<this.yLength;s++)this.population[e][s]=!1,this.kill(e,s);this.future=t.extend(!0,[],this.population),i&&this.toggle()},addLifeForm:function(t,i,e){var s,n,h;for(h=0;h<e.length;h++)s=(t+e[h][0]+this.xLength)%this.xLength,n=(i+e[h][1]+this.yLength)%this.yLength,this.populate(s,n),this.population[s][n]=!0},addGlider:function(t,i){this.addLifeForm(t,i,[[1,0],[2,1],[0,2],[1,2],[2,2]])},addWeekender:function(t,i){var e=[[2,0],[15,0],[2,1],[15,1],[1,2],[3,2],[14,2],[16,2],[2,3],[15,3],[2,4],[15,4],[3,5],[7,5],[8,5],[9,5],[10,5],[14,5],[7,6],[8,6],[9,6],[10,6],[3,7],[4,7],[5,7],[6,7],[11,7],[12,7],[13,7],[14,7],[5,9],[12,9],[6,10],[7,10],[10,10],[11,10]];this.addLifeForm(t,i,e)},addCustomLifeForm1:function(t,i){var e=[[2,0],[15,0],[2,1],[15,1],[1,2],[3,2],[14,2],[16,2],[2,3],[15,3],[2,4],[15,4],[3,5],[7,5],[8,5],[9,5],[10,5],[14,5],[7,6],[8,6],[9,6],[10,6],[3,7],[4,7],[5,7],[6,7],[11,7],[12,7],[13,7],[14,7],[5,9],[12,9],[6,10],[7,10],[10,9],[11,9]];this.addLifeForm(t,i,e)},advance:function(){this.future=t.extend(!0,[],this.population);for(var i=0;i<this.xLength;i++)for(var e=0;e<this.yLength;e++)this.live(i,e);for(var i=0;i<this.xLength;i++)for(var e=0;e<this.yLength;e++)this.population[i][e]!==this.future[i][e]&&(this.future[i][e]?this.populate(i,e):this.kill(i,e));this.population=this.future},toggle:function(){if(this.alive)clearInterval(this.timer),this.alive=!1;else{var t=this;this.timer=setInterval(function(){t.advance()},this.settings.speed),this.alive=!0}}}),t.fn.gameOfLife=function(i){return this.each(function(){t.data(this,"gameOfLife")||t.data(this,"gameOfLife",new n(this,i))})}}(jQuery,window,document);